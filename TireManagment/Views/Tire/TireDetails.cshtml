@section Styles{
    <link href="~/css/datatable.css" rel="stylesheet" />
    <link href="~/css/datatable1.css" rel="stylesheet" />
}

@model TireManagment.DbModels.Tire;
@inject TireManagment.Services.TireService tireservice;
@using TireManagment.DbModels;
<form class="form-horizontal" asp-action="TireDetials" asp-controller="Tire" method="get">
    <div class="input-group mb-3">
        <label class="text-justify " style="margin-top:8px;font-size:16px;font-family:'Times New Roman', Times, serif">Choose Tire</label>&nbsp;
        @if (Model != null)
        {
            <select name="tireid" style="width:100px" asp-items="@(new SelectList(ViewBag.tireserials, nameof(tirewithserial.tierid), nameof(tirewithserial.serial), Model.ID))" class="col-4 form-control" required>
                <option value="">Tire Serial</option>
            </select>
        }
        else
        {
    <select name="tireid" style="width:100px" asp-items="@(new SelectList(ViewBag.tireserials, nameof(tirewithserial.tierid), nameof(tirewithserial.serial)))" class="form-control" required>
        <option value="">Tire Serial</option>
    </select>
        }
        <div class="input-group-append">
            <button class="btn btn-info" type="submit">Get Details</button>
        </div>
    </div>
</form>
@if (Model != null)
{
    <section class="section dashboard">
        <div class="row">

            <!-- Left side columns -->
            <div class="col-lg-8">
                <div class="row">



                    <!-- Customers Card -->
                    <div class="col-xxl-4 col-xl-12">

                        <div class="card info-card customers-card">

                            <div class="filter">
                                <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                                <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                                    <li class="dropdown-header text-start">
                                        <h6>Filter</h6>
                                    </li>

                                    <li><a class="dropdown-item" href="#">Today</a></li>
                                    <li><a class="dropdown-item" href="#">This Month</a></li>
                                    <li><a class="dropdown-item" href="#">This Year</a></li>
                                </ul>
                            </div>

                            <div class="card-body">
                                @*<h5 class="card-title">Retread & Damaged <span>| Tires</span></h5>*@
                                <h5 class="card-title">Tire Details <span></span></h5>

                                <div class="d-flex align-items-center">
                                    <table class="table">
                                        <tr>
                                            <th> Id</th>
                                            <th> Serial</th>
                                            <th>Status</th>
                                            <th> Size</th>

                                            <th>Brand Name</th>
                                            <th>Adding Date</th>

                                        </tr>
                                        <tr>
                                            <td>@Model.ID</td>
                                            <td>@Model.Serial</td>
                                            <td>@Model.TireStatus</td>
                                            <td>@Model.Size</td>

                                            <td>@Model.Brand.Name</td>
                                            <td>@Model.SubmitDate</td>


                                        </tr>
                                    </table>
                                    @*<div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                                            <i class="bi bi-people"></i>
                                        </div>
                                        <div class="ps-3">
                                            <h6 id="retreadanddamaged"></h6>
                                            <span id="retread" class="text-danger small pt-1 fw-bold"></span> <span class="text-muted small pt-2 ps-1">Retread</span>
                                            <span id="damaged" class="text-danger small pt-1 fw-bold"></span> <span class="text-muted small pt-2 ps-1">Damaged</span>
                                        </div>*@
                                </div>

                            </div>
                        </div>

                    </div><!-- End Customers Card -->
                    <!-- Recent Sales -->
                    <div class="col-12">
                        <div class="card recent-sales overflow-auto">

                            <div class="filter">
                                <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                                <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                                    <li class="dropdown-header text-start">
                                        <h6>Filter</h6>
                                    </li>

                                    <li><a class="dropdown-item" href="#">Today</a></li>
                                    <li><a class="dropdown-item" href="#">This Month</a></li>
                                    <li><a class="dropdown-item" href="#">This Year</a></li>
                                </ul>
                            </div>

                            <div class="card-body">
                                <h5 class="card-title">Tire Movements<span>| Last <b>5</b> Movement available on the system </span></h5>

                                <table id="example" class="display nowrap  table-borderless" style="">
                                    <thead>
                                        <tr>
                                        <th>Id</th>
                                            <th>Movement Type</th>
                                            <th>Movement Date</th>
                                            <th>Truck Number</th>
                                            <th>TireMan</th>



                                            <th>details</th>
                                          
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{ var history =(IEnumerable<MovementDetails>)ViewBag.TireHistory;}
                                        @foreach (MovementDetails movement in history)
                                        {

                                        <tr>
                                            <td>@movement.Id</td>
                                            <td>@movement.TireMovement.MovementType</td>
                                            <td>@movement.TireMovement.SubmitDate</td>
                                            <td>@movement.TireMovement.TruckNumber</td>
                                        
                                            <td>@movement.TireMovement.Tireman.Name</td>
                                  

                                            <td> CurrentTireDepth:&nbsp; @movement.CurrentTireDepth  &nbsp;&nbsp; STDthreadDepth : @movement.STDthreadDepth  &nbsp;&nbsp; KMWhileChange:  @movement.KMWhileChange &nbsp;&nbsp;Tire Position: @movement.Position</td>

                                        </tr>

                                        }

                                    </tbody>
                                </table>

                            </div>

                        </div>
                    </div><!-- End Recent Sales -->

                </div>
            </div><!-- End Left side columns -->
            <!-- Right side columns -->
            <div class="col-lg-4">

                <!-- Recent Activity -->
                <div class="card">
                    <div class="filter">
                        <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                            <li class="dropdown-header text-start">
                                <h6>Filter</h6>
                            </li>

                            <li><a class="dropdown-item" href="#">Today</a></li>
                            <li><a class="dropdown-item" href="#">This Month</a></li>
                            <li><a class="dropdown-item" href="#">This Year</a></li>
                        </ul>
                    </div>

                    <div class="card-body">
                        <h5 class="card-title">Truck Tires <span>| Truck Tire In Postion</span></h5>

                        <div class="activity justify-content-center">
                          @{var image = tireservice.GetTireCategoryImage(Model.ID); }
                          <img  src="~/Img/@image" width="200"/>

                        </div>

                    </div>
                </div><!-- End Recent Activity -->
                <!-- News & Updates Traffic -->
                <div class="card">
                    <div class="filter">
                        <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                            <li class="dropdown-header text-start">
                                <h6>Filter</h6>
                            </li>

                            <li><a class="dropdown-item" href="#">Today</a></li>
                            <li><a class="dropdown-item" href="#">This Month</a></li>
                            <li><a class="dropdown-item" href="#">This Year</a></li>
                        </ul>
                    </div>

                    <div class="card-body pb-0">
                        @*<h5 class="card-title">News &amp; Updates <span>| Today</span></h5>*@
                        <h5 class="card-title">Export Tire Movements to Excel Sheet</h5>
                        <div class="news">
                            <form class="form-horizontal" asp-action="FindMovements" asp-controller="Tire" method="get" style="width:100%;">
                                <div class="input-group mb-3">
                                    <div class="row">
                                       
                                            
                                     
                                            <label style="font-weight:bold">Start Date</label>
                                            <input required type="datetime-local" style="width:300px" name="startdate" />
                                        <br /><br />
                                      
                                            <label style="font-weight:bold">End Date</label>
                                            <input  required type="datetime-local" style="width:300px" name="enddate" />
                                        <input  type="hidden" name="tireid" value="@Model.TireId" />
                                       <br />
                                        <br />
                                            <button class="btn btn-success" style="font-size:15px" type="submit">Export to Excel</button>

                                       
                                    </div>
                                </div>
                                <div>
                                    @*   <label class="text-justify " style="margin-top:8px;font-size:16px;font-family:'Times New Roman', Times, serif">Choose Truck</label>&nbsp;*@


                                </div>
                            </form>


                        </div><!-- End sidebar recent posts-->

                    </div>
                </div><!-- End News & Updates -->

            </div><!-- End Right side columns -->

        </div>
    </section>

    @*<table class="table table-dark">
            <tr>
                <th> Tire Serial</th>
                <th>Tire Size</th>
                <th>Tire Status</th>
                <th>Tire Submit Date</th>
                <th>Tire Brand</th>
                <th>Tire Truck Number</th>
            </tr>
            <tr>
                <td>@Model.Serial</td>
                <td>@Model.Size</td>
                <td>@Model.TireStatus</td>
                <td>@Model.SubmitDate</td>
                <td>@Model.Brand.Name</td>
                @if (ViewBag.TruckNumber != null)
                {
                    <td>@ViewBag.TruckNumber</td>
                }
                else
                {
                    <td>Not Applicable</td>
                }

            </tr>
        </table>*@
    @*<table id="example" class="display nowrap" style="width:100%">
            <thead>
            <tr>
                <th>Position</th>
                <th>STDthreadDepth</th>
                <th>KMWhileChange</th>
                <th>CurrentTireDepth</th>
                <th>details</th>


            </tr>
                </thead>
            @foreach (MovementDetails movement in ViewBag.TireHistory)
            {
                <tr>
                    <td>@movement.Position</td>
                    <td>@movement.STDthreadDepth</td>
                    <td>@movement.KMWhileChange</td>
                    <td>@movement.CurrentTireDepth</td>

                <td> Movement Date:&nbsp; @movement.TireMovement.SubmitDate  &nbsp;&nbsp; STDthreadDepth : @movement.STDthreadDepth  &nbsp;&nbsp; KMWhileChange:  @movement.KMWhileChange</td>

                </tr>
            }
        </table>*@


}
@section Scripts{

    <script crossorigin="anonymous" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script crossorigin="anonymous" src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#example').DataTable({
               
                order: [[3, "desc"]],
                responsive: true,
            });
        });
    </script>
}